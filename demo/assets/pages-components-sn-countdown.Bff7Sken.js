import{_ as t,a as e}from"./sn-topbar.CX0rMkKy.js";import{d as a,r as n,c as l,w as o,l as s,y as u,b as c,t as i,g as r,u as m,o as f,e as p,f as d,k as v}from"./index-DNTc1GxZ.js";import{$ as x,b as y,r as S}from"./uni-app.es.D9ZkitmT.js";import{b as h,a as _,_ as g,c as w}from"./sn-button.BaZjRh9m.js";import{_ as z}from"./com-card.22LSjaaf.js";import{_ as b}from"./sn-tag.DvvI2107.js";import{_ as j}from"./sn-page.CEVOSUw5.js";const C=a(Object.assign({name:"sn-countdown"},{__name:"sn-countdown",props:{format:{type:String,default:"HH:mm:ss"},time:{type:Number,default:0},autoplay:{type:Boolean,default:!0},millisecond:{type:Boolean,default:!1},textSize:{type:String,default:""},textColor:{type:String,default:""},customStyle:{type:Object,default:{}}},emits:["change","finish"],setup(t,e){var a=e.expose,f=e.emit;const p=x.colors,d=f,v=t,_=n(""),g=n(0),w=n(0),z=n(0),b=n(!1),j=n(new y({d:0,h:0,m:0,s:0,ms:0})),C=l((()=>""==v.textSize?x.configs.font.baseSize:v.textSize)),D=l((()=>""==v.textColor?p.value.text:v.textColor));function M(){clearTimeout(g.value),g.value=0}function H(t){const e=1e3,a=60*e,n=60*a,l=24*n,o=Math.floor(t/l),s=Math.floor(t%l/n),u=Math.floor(t%n/a),c=Math.floor(t%a/e),i=Math.floor(t%e);return new y({d:o,h:s,m:u,s:c,ms:i})}function k(t,e){let a=e.d,n=e.h,l=e.m,o=e.s,s=e.ms;return-1==t.indexOf("DD")?n+=24*a:t=t.replace("DD","".concat(a).padStart(2,"0")),-1==t.indexOf("HH")?l+=60*n:t=t.replace("HH","".concat(n).padStart(2,"0")),-1==t.indexOf("mm")?o+=60*l:t=t.replace("mm","".concat(l).padStart(2,"0")),-1==t.indexOf("ss")?s+=1e3*o:t=t.replace("ss","".concat(o).padStart(2,"0")),t.replace("SSS","".concat(s).padStart(3,"0")).replace("SS","".concat(Math.trunc(s/10)).padStart(2,"0")).replace("S","".concat(Math.trunc(s/100)))}function O(){b.value=!1,M()}function T(){return Math.max(w.value-Date.now(),0)}function B(){O(),z.value=0,j.value=H(0),d("change",j.value),_.value=k(v.format,j.value),d("finish")}function I(t){z.value=t,j.value=H(t),d("change",j.value),_.value=k(v.format,j.value),t<=0&&B()}function $(){M(),g.value=setTimeout((()=>{let t=T();var e,a;e=t,a=z.value,(Math.floor(e/1e3)!=Math.floor(a/1e3)||0==t)&&I(t),0!=z.value&&$()}),30)}function q(){M(),g.value=setTimeout((()=>{I(T()),0!=z.value&&q()}),10)}function A(){v.millisecond?q():$()}function E(){if(b.value)return null;b.value=!0,w.value=Date.now()+z.value,A()}function F(){O(),z.value=v.time,I(z.value),v.autoplay&&E()}function N(){F()}a({start:E,pause:O,reset:F,stop:B});const P=l((()=>v.time));return o(P,(()=>{N()})),s((()=>{N()})),u((()=>{M()})),(e=null,a=null)=>{const n=S(c("sn-text"),h);return i(e.$slots,"default",{},(()=>[r(n,{text:m(_),color:m(D),size:m(C),customStyle:t.customStyle},null,8,["text","color","size","customStyle"])]))}}})),D=w(a({__name:"sn-countdown",setup(a){const l=x.colors,o=n(!0),s=n(new y({d:0,h:0,m:0,s:0,ms:0})),u=n(null);function i(t){s.value=t}function w(){o.value=!o.value,o.value?u.value.start():u.value.pause()}function D(){o.value=!1,u.value.stop()}function M(){o.value=!0,u.value.reset()}return(a=null,n=null)=>{const y=S(c("sn-topbar"),t),H=S(c("sn-countdown"),C),k=S(c("com-card"),z),O=S(c("sn-tag"),b),T=S(c("sn-text"),h),B=S(c("sn-row"),e),I=S(c("sn-icon"),_),$=S(c("sn-button"),g),q=v,A=S(c("sn-page"),j);return f(),p(A,null,{default:d((()=>[r(y,{title:"Countdown 倒计时"}),r(k,{title:"基础用法",note:"顾名思义，就是一个倒计时。\\n推荐使用插槽布局为主，样式更好调。"},{default:d((()=>[r(H,{time:3e5})])),_:1}),r(k,{title:"自定义样式",note:"可以自由设置文本的颜色和大小等样式"},{default:d((()=>[r(H,{time:3e5,textColor:m(l).successDark,textSize:m(x).configs.font.size(3),customStyle:{fontFamily:"alipuhuiheavy"}},null,8,["textColor","textSize"])])),_:1}),r(k,{title:"格式化",note:"倒计时内置文字支持时间格式化（参照Day.js）。"},{default:d((()=>[r(H,{format:"DD 天 HH 小时 mm 分钟 ss 秒",time:3e5})])),_:1}),r(k,{title:"毫秒精度",note:"虽然使用一般模式也支持获取毫秒，但误差极大，不如此模式精确。"},{default:d((()=>[r(H,{format:"mm:ss.SSS",millisecond:"",time:3e5})])),_:1}),r(k,{title:"插槽",note:"推荐使用插槽模式，自由度更高。"},{default:d((()=>[r(H,{millisecond:"",time:3e5,onChange:i},{default:d((()=>[r(B,null,{default:d((()=>[r(O,{class:"spacing",type:"primary",text:"".concat(m(s).h)},null,8,["text"]),r(T,{class:"spacing",text:"时",font:"alipuhuiheavy"}),r(O,{class:"spacing",type:"primary",text:"".concat(m(s).m)},null,8,["text"]),r(T,{class:"spacing",text:"分",font:"alipuhuiheavy"}),r(O,{class:"spacing",type:"primary",text:"".concat(m(s).s)},null,8,["text"]),r(T,{class:"spacing",text:"秒",font:"alipuhuiheavy"})])),_:1})])),_:1})])),_:1}),r(k,{title:"自由控制",note:"提供 API 以自由控制倒计时的状态。"},{default:d((()=>[r(q,{class:"align-items-center"},{default:d((()=>[r(H,{ref_key:"countdownEle",ref:u,format:"mm:ss.SS",millisecond:"",time:3e5},null,512),r(B,{align:"center"},{default:d((()=>[r($,{"round-size":"50px",round:"",onClick:M},{default:d((()=>[r(I,{name:"refresh-line"})])),_:1}),r($,{class:"m-l-10",type:"primary",level:"second","round-size":"60px",round:"",onClick:w},{default:d((()=>[r(I,{name:"".concat(m(o)?"pause":"play","-fill"),color:m(l).primary},null,8,["name","color"])])),_:1}),r($,{class:"m-l-10","round-size":"50px",round:"",onClick:D},{default:d((()=>[r(I,{name:"stop-circle-fill"})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-8e64d7d9"]]);export{D as default};
