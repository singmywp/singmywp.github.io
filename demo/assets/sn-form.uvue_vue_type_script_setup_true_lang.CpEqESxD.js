import{d as e,r as l,c as t,l as a,m as s,w as o,e as u,f as n,q as r,k as i,o as c,t as d}from"./index-DNTc1GxZ.js";import{$ as f,k as p}from"./uni-app.es.D9ZkitmT.js";const m=e(Object.assign({name:"sn-form"},{__name:"sn-form",props:{modelValue:{type:Object,default:{}},type:{type:String,default:"embed"},showError:{type:Boolean,default:!0},labelColor:{type:String,default:""},labelSize:{type:String,default:""},labelWidth:{type:String,default:"auto"},showBorder:{type:Boolean,default:!0},triggerChange:{type:Boolean,default:!1},customStyle:{type:Object,default:new UTSJSONObject({})}},emits:["update:modelValue","submited","change"],setup(e,m){var b=m.expose,h=m.emit;f.utils;const y=f.colors,g=h,S=e,v=l([]),w=l([]),j=t((()=>["embed","float"].includes(S.type)?S.type:"embed")),O=t((()=>""==S.labelColor?y.value.textLight:S.labelColor)),B=t((()=>""==S.labelSize?f.configs.font.size(3):S.labelSize)),C=t((()=>{let e=new Map;return e.set("type",j.value),e.set("labelColor",O.value),e.set("labelSize",B.value),e.set("showBorder",S.showBorder),e.set("showError",S.showError),e}));function z(){w.value.forEach((e=>{e.$callMethod("setProps",C.value)}))}function E(e){let l=!0,t=[];v.value.forEach((e=>{let a=e.field,s=new UTSJSONObject(S.modelValue)[a];if(null!=s){null!=UTS.arrayFind(v.value,(e=>e.field==a))&&e.instance.$callMethod("verify",s,(e=>{e.valid||(l=!1,t.push(e))}))}else l=!1})),l?null!=e.success&&e.success():null!=e.fail&&e.fail(t)}return b({submit:function(e){E(new p({success:()=>{null!=e.success&&(g("submited"),e.success())},fail:l=>{null!=e.fail&&e.fail(l)}}))},register:function(e){v.value.push(e),w.value.push(e.instance)}}),a((()=>{s((()=>{z()}))})),o(C,(()=>{z()}),{immediate:!0}),o(S.modelValue,(e=>{g("update:modelValue",e),g("change",e),S.triggerChange&&E(new p({}))})),(l=null,t=null)=>{const a=i;return c(),u(a,{class:"sn-form",style:r([e.customStyle])},{default:n((()=>[d(l.$slots,"default")])),_:3},8,["style"])}}}));export{m as _};
