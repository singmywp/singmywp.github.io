import{d as e,$ as t,r as a,c as l,l as o,a as s,b as i,e as n,q as u,u as r,y as d,j as c,o as g,T as m,U as v,f,C as h,m as p,a7 as y,M as w}from"./index-DoInGK9X.js";import{_ as S}from"./sn-view.BKJ7GZxj.js";import{r as b}from"./uni-app.es.K1mZmM8s.js";import{a as j,c as k}from"./sn-button.B1LvAG78.js";import{u as O}from"./useResize.Dia-r-oM.js";const _=k(e(Object.assign({name:"sn-image"},{__name:"sn-image",props:{width:{type:String,default:""},height:{type:String,default:""},src:{type:String,default:""},mode:{type:String,default:"aspectFit"},borderRadius:{type:String,default:""},loadingBgColor:{type:String,default:""},loadingSize:{type:String,default:"80px"},lazyLoad:{type:Boolean,default:!1},fadeShow:{type:Boolean,default:!0},enablePreview:{type:Boolean,default:!1},customStyle:{type:Object,default:new UTSJSONObject({})},customImageStyle:{type:Object,default:new UTSJSONObject({})},customLoadingStyle:{type:Object,default:new UTSJSONObject({})}},emits:["error","load","click","dbclick","longpress"],setup(e,k){var _=k.emit;const z=t.utils,B=t.colors,L=_,T=e,x=a(!1),C=a(!1),M=a("auto"),U=a("auto"),R=a(!1),I=a({width:0,height:0}),J=a(null),N=l((()=>"auto"!=T.width&&""!=T.width));l((()=>"auto"!=T.height&&""!=T.height));const D=l((()=>"aspectFit"==T.mode&&""==T.height)),E=l((()=>d("color",T.loadingBgColor,B.value.info))),F=l((()=>d("radius",T.borderRadius,t.configs.radius.small))),P=l((()=>d("color",T.loadingBgColor,B.value.infoDark))),q=l((()=>{let e=new Map;return D.value?N.value?(e.set("width",M.value),e.set("height",U.value)):e.set("flex","1"):(e.set("width",M.value),e.set("height",U.value)),e.set("border-radius",F.value),e.set("transition-duration",t.configs.aniTime.normal),e})),G=l((()=>{let e=new Map;return e.set("width",M.value),e.set("height",U.value),e.set("border-radius",F.value),e.set("transition-duration",t.configs.aniTime.normal),e})),$=l((()=>{let e=new Map;return e.set("background",E.value),e.set("width",T.loadingSize),e.set("height",T.loadingSize),e.set("border-radius",F.value),e.set("transition-duration",t.configs.aniTime.normal),e}));function A(e){L("error",e),x.value=!0}function H(){let e=I.value;0!=e.width&&p((()=>{var t;let a=null===(t=J.value)||void 0===t?void 0:t.getBoundingClientRect();null!=a&&null!=a.width&&(M.value="".concat(a.width,"px"),U.value="".concat(a.width*(e.height/e.width),"px"))}))}function K(e){C.value=!0,L("load",e),D.value&&(p((()=>{I.value=e.detail,H(),setTimeout((()=>{H()}),3e3)})),R.value=!0)}function Q(e){z.debounce((()=>{T.enablePreview&&!x.value&&y({urls:[T.src]}),L("click",e.event)}),300)}function V(e){z.debounce((()=>{L("dbclick",e.event)}),300)}function W(e){L("longpress",e)}return o((()=>{D.value?N.value&&(M.value=T.width):(M.value=T.width,U.value=T.height),O(J.value,(()=>{R.value&&H()}))})),(t=null,a=null)=>{const l=w,o=b(s("sn-view"),S),d=b(s("sn-icon"),j),p=c;return g(),i(p,{class:"sn-image-contain",ref_key:"containEle",ref:J,style:u([r(q),e.customStyle])},{default:n((()=>[m(f(o,{class:"sn-image",onClick:Q,onDbclick:V,onLongpress:W,style:u([r(q),e.customStyle])},{default:n((()=>[f(l,{class:"sn-image-image",src:e.src,mode:e.mode,lazyLoad:e.lazyLoad,fadeShow:e.fadeShow,onError:A,onLoad:K,style:u([r(G),e.customImageStyle])},null,8,["src","mode","lazyLoad","fadeShow","style"])])),_:1},8,["style"]),[[v,r(C)]]),r(C)?h("",!0):(g(),i(p,{key:0,class:"sn-image-unloaded",style:u([r($),e.customLoadingStyle])},{default:n((()=>[f(d,{name:"image-line",color:r(P)},null,8,["color"])])),_:1},8,["style"]))])),_:1},8,["style"])}}})),[["__scopeId","data-v-44a0c786"]]);export{_};
