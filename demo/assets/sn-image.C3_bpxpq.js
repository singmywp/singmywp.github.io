import{d as e,r as a,c as t,l,b as o,e as i,f as s,q as n,u,k as r,o as d,N as c,O as g,g as m,v,m as f,a5 as h,I as p}from"./index-DNTc1GxZ.js";import{_ as y}from"./sn-view.JTcvHBKf.js";import{$ as w,r as S}from"./uni-app.es.D9ZkitmT.js";import{a as b,c as k}from"./sn-button.BaZjRh9m.js";import{u as _}from"./useResize.BiiI_cO4.js";const j=k(e(Object.assign({name:"sn-image"},{__name:"sn-image",props:{width:{type:String,default:""},height:{type:String,default:""},src:{type:String,default:""},mode:{type:String,default:"aspectFit"},borderRadius:{type:String,default:""},loadingBgColor:{type:String,default:""},loadingSize:{type:String,default:"80px"},lazyLoad:{type:Boolean,default:!1},fadeShow:{type:Boolean,default:!0},enablePreview:{type:Boolean,default:!1},customStyle:{type:Object,default:{}},customImageStyle:{type:Object,default:{}},customLoadingStyle:{type:Object,default:{}}},emits:["error","load","click","dbclick","load","error","longpress"],setup(e,k){var j=k.emit;const z=w.utils,B=w.colors,C=j,L=e,x=a(!1),O=a(!1),R=a("auto"),I=a("auto"),T=a(!1),M=a({width:0,height:0}),D=a(null),E=t((()=>"auto"!=L.width&&""!=L.width));t((()=>"auto"!=L.height&&""!=L.height));const F=t((()=>"aspectFit"==L.mode&&""==L.height)),P=t((()=>""==L.loadingBgColor?B.value.info:L.loadingBgColor)),q=t((()=>""==L.borderRadius?w.configs.radius.small:L.borderRadius)),N=t((()=>""==L.loadingBgColor?B.value.infoDark:L.loadingBgColor)),$=t((()=>{let e=new Map;return F.value?E.value?(e.set("width",R.value),e.set("height",I.value)):e.set("flex","1"):(e.set("width",R.value),e.set("height",I.value)),e.set("border-radius",q.value),e.set("transition-duration",w.configs.aniTime.normal),e})),A=t((()=>{let e=new Map;return e.set("width",R.value),e.set("height",I.value),e.set("border-radius",q.value),e.set("transition-duration",w.configs.aniTime.normal),e})),G=t((()=>{let e=new Map;return e.set("background",P.value),e.set("width",L.loadingSize),e.set("height",L.loadingSize),e.set("border-radius",q.value),e.set("transition-duration",w.configs.aniTime.normal),e}));function H(e){C("error",e),x.value=!0}function J(){let e=M.value;0!=e.width&&f((()=>{var a;let t=null===(a=D.value)||void 0===a?void 0:a.getBoundingClientRect();null!=t&&null!=t.width&&(R.value="".concat(t.width,"px"),I.value="".concat(t.width*(e.height/e.width),"px"))}))}function K(e){O.value=!0,C("load",e),F.value&&(f((()=>{M.value=e.detail,J(),setTimeout((()=>{J()}),3e3)})),T.value=!0)}function Q(e){z.debounce((()=>{L.enablePreview&&!x.value&&h({urls:[L.src]}),C("click",e.event)}),300)}function U(e){z.debounce((()=>{C("dbclick",e.event)}),300)}return l((()=>{F.value?E.value&&(R.value=L.width):(R.value=L.width,I.value=L.height),_(D.value,(()=>{T.value&&J()}))})),(a=null,t=null)=>{const l=p,f=S(o("sn-view"),y),h=S(o("sn-icon"),b),w=r;return d(),i(w,{class:"sn-image-contain",ref_key:"containEle",ref:D,style:n([u($),e.customStyle])},{default:s((()=>[c(m(f,{class:"sn-image",onClick:Q,onDbclick:U,style:n([u($),e.customStyle])},{default:s((()=>[m(l,{class:"sn-image-image",src:e.src,mode:e.mode,lazyLoad:e.lazyLoad,fadeShow:e.fadeShow,onError:H,onLoad:K,style:n([u(A),e.customImageStyle])},null,8,["src","mode","lazyLoad","fadeShow","style"])])),_:1},8,["style"]),[[g,u(O)]]),u(O)?v("",!0):(d(),i(w,{key:0,class:"sn-image-unloaded",style:n([u(G),e.customLoadingStyle])},{default:s((()=>[m(h,{name:"image-line",color:u(N)},null,8,["color"])])),_:1},8,["style"]))])),_:1},8,["style"])}}})),[["__scopeId","data-v-10f7a37a"]]);export{j as _};
