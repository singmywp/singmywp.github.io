import{d as e,$ as t,r as a,c as l,l as o,a as s,b as i,e as n,q as u,u as r,z as d,j as c,o as g,T as m,U as v,f,v as h,m as p,a7 as y,M as w}from"./index-BDGnenFq.js";import{_ as S}from"./sn-view.D-czNReK.js";import{r as b}from"./uni-app.es.BfR9KIrQ.js";import{a as j,c as k}from"./sn-button.DCeBN0oM.js";import{u as z}from"./useResize.C1IVTLMN.js";const O=k(e(Object.assign({name:"sn-image"},{__name:"sn-image",props:{width:{type:String,default:""},height:{type:String,default:""},src:{type:String,default:""},mode:{type:String,default:"aspectFit"},borderRadius:{type:String,default:""},loadingBgColor:{type:String,default:""},loadingSize:{type:String,default:"80px"},lazyLoad:{type:Boolean,default:!1},fadeShow:{type:Boolean,default:!0},enablePreview:{type:Boolean,default:!1},customStyle:{type:Object,default:new UTSJSONObject({})},customImageStyle:{type:Object,default:new UTSJSONObject({})},customLoadingStyle:{type:Object,default:new UTSJSONObject({})}},emits:["error","load","click","dbclick","longpress"],setup(e,k){var O=k.emit;const _=t.utils,L=t.colors,T=O,B=e,x=a(!1),C=a(!1),M=a("auto"),R=a("auto"),U=a(!1),F=a({width:0,height:0}),I=a(null),J=l((()=>"auto"!=B.width&&""!=B.width));l((()=>"auto"!=B.height&&""!=B.height));const N=l((()=>"aspectFit"==B.mode&&""==B.height)),D=l((()=>d("color",B.loadingBgColor,L.value.info))),E=l((()=>d("radius",B.borderRadius,t.configs.radius.small))),P=l((()=>d("color",B.loadingBgColor,L.value.infoDark))),q=l((()=>{let e=new Map;return N.value?J.value?(e.set("width",M.value),e.set("height",R.value)):e.set("flex","1"):(e.set("width",M.value),e.set("height",R.value)),e.set("border-radius",E.value),e.set("transition-duration",t.configs.aniTime.normal),e})),$=l((()=>{let e=new Map;return e.set("width",M.value),e.set("height",R.value),e.set("border-radius",E.value),e.set("transition-duration",t.configs.aniTime.normal),e})),A=l((()=>{let e=new Map;return e.set("background",D.value),e.set("width",B.loadingSize),e.set("height",B.loadingSize),e.set("border-radius",E.value),e.set("transition-duration",t.configs.aniTime.normal),e}));function G(e){T("error",e),x.value=!0}function H(){let e=F.value;0!=e.width&&p((()=>{var t;let a=null===(t=I.value)||void 0===t?void 0:t.getBoundingClientRect();null!=a&&null!=a.width&&(M.value="".concat(a.width,"px"),R.value="".concat(a.width*(e.height/e.width),"px"))}))}function K(e){C.value=!0,T("load",e),N.value&&(p((()=>{F.value=e.detail,H(),setTimeout((()=>{H()}),3e3)})),U.value=!0)}function Q(e){_.debounce((()=>{B.enablePreview&&!x.value&&y({urls:[B.src]}),T("click",e.event)}),300)}function V(e){_.debounce((()=>{T("dbclick",e.event)}),300)}function W(e){T("longpress",e)}return o((()=>{N.value?J.value&&(M.value=B.width):(M.value=B.width,R.value=B.height),z(I.value,(()=>{U.value&&H()}))})),(t=null,a=null)=>{const l=w,o=b(s("sn-view"),S),d=b(s("sn-icon"),j),p=c;return g(),i(p,{class:"sn-image-contain",ref_key:"containEle",ref:I,style:u([r(q),e.customStyle])},{default:n((()=>[m(f(o,{class:"sn-image",onClick:Q,onDbclick:V,onLongpress:W,style:u([r(q),e.customStyle])},{default:n((()=>[f(l,{class:"sn-image-image",src:e.src,mode:e.mode,lazyLoad:e.lazyLoad,fadeShow:e.fadeShow,onError:G,onLoad:K,style:u([r($),e.customImageStyle])},null,8,["src","mode","lazyLoad","fadeShow","style"])])),_:1},8,["style"]),[[v,r(C)]]),r(C)?h("",!0):(g(),i(p,{key:0,class:"sn-image-unloaded",style:u([r(A),e.customLoadingStyle])},{default:n((()=>[f(d,{name:"image-line",color:r(P)},null,8,["color"])])),_:1},8,["style"]))])),_:1},8,["style"])}}})),[["__scopeId","data-v-44a0c786"]]);export{O as _};
