import{d as e,$ as a,r as t,l,m as n,c as o,a as u,b as s,e as r,q as i,C as c,ae as f,y as d,j as p,o as v,T as m,U as y,u as g,f as h}from"./index-DoInGK9X.js";import{a as S,c as b}from"./sn-button.B1LvAG78.js";import{r as x}from"./uni-app.es.K1mZmM8s.js";const C=b(e(Object.assign({name:"sn-rate"},{__name:"sn-rate",props:{modelValue:{type:Number,default:0},count:{type:Number,default:5},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},allowHalf:{type:Boolean,default:!1},spacing:{type:String,default:"5px"},inactiveColor:{type:String,default:""},activeColor:{type:String,default:""},icon:{type:String,default:"star-fill"},iconSize:{type:String,default:""},activeIcon:{type:String,default:""},halfIcon:{type:String,default:"star-half-fill"},customStyle:{type:Object,default:new UTSJSONObject({})}},emits:["change","update:modelValue"],setup(e,b){var C=b.emit;const I=a.colors,j=a.utils,w=C,z=e,B=j.randomComId(),M=j.randomComId(),_=t(null),H=t(null);l((()=>{n((()=>{_.value=f(B),H.value=f(M)}))}));const O=o({get:()=>z.modelValue,set:e=>{w("update:modelValue",e)}}),T=o((()=>{let e=z.activeIcon;return j.isEmpty(e)?z.icon:e})),V=o((()=>Math.min(z.count,Math.max(O.value,0)))),N=o((()=>{if(z.allowHalf){let e=Math.trunc(V.value);return(T.value+",").repeat(e)+(V.value-e==.5?z.halfIcon:"")}return(T.value+",").repeat(V.value)})),k=o((()=>Math.max(z.count-V.value,0))),R=o((()=>((z.allowHalf&&"star-fill"==z.icon?"star-line":z.icon)+",").repeat(Math.trunc(k.value)))),U=o((()=>{if(V.value>0&&null!=_.value&&null!=H.value){let e=_.value.getBoundingClientRect();return[e.x,e.y]}if(0==V.value&&null!=H){let e=H.value.getBoundingClientRect();return[e.x,e.y]}return[0,0]})),W=o((()=>null!=_.value&&null!=H.value?_.value.offsetWidth+H.value.offsetWidth:0)),q=o((()=>d("color",z.inactiveColor,I.value.infoDark))),D=o((()=>d("color",z.activeColor,I.value.warning))),E=o((()=>d("font",z.iconSize,a.configs.font.size(4)))),G=o((()=>{let e=new Map;return e.set("letterSpacing",z.spacing),e}));function J(e){let a=z.count;if(!z.readonly){let t=e.touches[0].clientX-U.value[0],l=W.value/a,n=parseInt((t/l).toString()),o=n+(z.allowHalf?t/l-n>.5?1:.5:1);o>a?o=a:o<0&&(o=0),z.clearable&&o==O.value&&(o=0),O.value=o,w("change",o)}}return(a=null,t=null)=>{const l=x(u("sn-icon"),S),n=p;return e.count>0?(v(),s(n,{key:0,class:"sn-rate",style:i([e.customStyle])},{default:r((()=>[m(h(l,{class:"sn-rate-prefix",id:g(B),name:g(N),color:g(D),size:g(E),onTouchstart:J,style:i(g(G))},null,8,["id","name","color","size","style"]),[[y,g(V)>0]]),m(h(l,{class:"sn-rate-suffix",id:g(M),name:g(R),color:g(q),size:g(E),onTouchstart:J,style:i(g(G))},null,8,["id","name","color","size","style"]),[[y,g(k)>0]])])),_:1},8,["style"])):c("",!0)}}})),[["__scopeId","data-v-ecccb6bd"]]);export{C as _};
