import{d as e,c as t}from"./sn-button.B1LvAG78.js";import{d as n,$ as i,r as l,w as a,c as o,l as s,a as u,b as c,e as d,u as r,p as f,q as h,y as p,a9 as v,aa as m,ab as y,j as g,o as w,B as b,C as T,m as X}from"./index-DoInGK9X.js";import{r as Y}from"./uni-app.es.K1mZmM8s.js";const x=t(n(Object.assign({name:"sn-view"},{__name:"sn-view",props:{loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},bgColor:{type:String,default:""},borderRadius:{type:String,default:""},margin:{type:String,default:"0"},padding:{type:String,default:"0"},boxShadow:{type:String,default:""},aniTime:{type:String,default:i.configs.aniTime.long},customStyle:{type:Object,default:new UTSJSONObject({})}},emits:["click","longpress","dbclick","touchstart","touchmove","touchend","touchcancel","down"],setup(t,n){var x=n.emit;const S=i.colors,k=i.utils,M=x,j=t,G=l(null),U=new Map,_=l(!1),C=l(!1),B=l(k.randomComId()),E=l(null);a((()=>j.disabled),(e=>{var t,n;e?(C.value=!0,X((()=>{k.debounce((()=>{var e,t;null===(t=null===(e=E.value)||void 0===e?void 0:e.style)||void 0===t||t.setProperty("opacity",.3)}),50,B.value)}))):(null===(n=null===(t=E.value)||void 0===t?void 0:t.style)||void 0===n||n.setProperty("opacity",0),k.debounce((()=>{C.value=!1}),parseInt(j.aniTime),B.value))}),{immediate:!0});const O=o((()=>p("color",j.bgColor,""))),I=o((()=>p("radius",j.borderRadius,""))),L=o((()=>p("aniTime",j.aniTime,"0ms"))),P=o((()=>{let e=new Map;return e.set("background",O.value),e.set("padding",j.padding),e.set("box-shadow",j.boxShadow),e.set("border-radius",I.value),e.set("justify-content",j.loading?"center":""),e.set("align-items",j.loading?"center":""),e.set("transition-duration",L.value),e})),R=o((()=>{let e=new Map;return e.set("background",S.value.disabled),e.set("transition-duration",L.value),e}));function $(e){let t="click";null==G.value?G.value=setTimeout((()=>{G.value=null}),300):(clearTimeout(G.value),G.value=null,t="dbclick");let n=new v({type:t,event:e,x:e.clientX,y:e.clientY});M("down",n),M("dbclick"==t?"dbclick":"click",n)}function q(e){for(let t=0;t<e.length;t++)U.delete(e[t])}function D(e){let t=[];if(U.has(e.identifier)){let n=UTS.mapGet(U,e.identifier),i=e.clientX-UTS.mapGet(n,"x"),l=e.clientY-UTS.mapGet(n,"y");t=[i,l,Math.abs(i)>Math.abs(l)?i<0?"left":"right":l<0?"up":"down"]}else{let n=new Map;n.set("x",e.clientX),n.set("y",e.clientY),t=[0,0,""],U.set(e.identifier,n)}return t}function J(e){let t=[];t=e.touches,t=[];for(let i=0;i<e.touches.length;i++)t.push(e.touches[i]);let n=new m({type:"longpress",touches:t.map((e=>{let t=D(e);return new y({x:e.clientX,y:e.clientY,diffX:t[0],diffY:t[1],direction:"",id:e.identifier})})),event:e});M("longpress",n)}function N(e){_.value=!0;let t=[];t=e.touches,t=[];for(let i=0;i<e.touches.length;i++)t.push(e.touches[i]);let n=new m({type:"touchstart",touches:t.map((e=>{let t=D(e);return new y({x:e.clientX,y:e.clientY,diffX:t[0],diffY:t[1],direction:t[2],id:e.identifier})})),event:e});M("down",n),M("touchstart",n)}function z(e){_.value=!1;let t=[],n=[];n=e.changedTouches,n=[];for(let l=0;l<e.changedTouches.length;l++)n.push(e.changedTouches[l]);let i=new m({type:"touchend",touches:n.map((e=>{let n=D(e);return t.push(e.identifier),new y({x:e.clientX,y:e.clientY,diffX:n[0],diffY:n[1],direction:n[2],id:e.identifier})})),event:e});q(t),M("touchend",i)}function A(e){_.value=!1;let t=[],n=[];n=e.changedTouches,n=[];for(let l=0;l<e.changedTouches.length;l++)n.push(e.changedTouches[l]);let i=new m({type:"touchcancel",touches:n.map((e=>{let n=D(e);return t.push(e.identifier),new y({x:e.clientX,y:e.clientY,diffX:n[0],diffY:n[1],direction:n[2],id:e.identifier})})),event:e});q(t),M("touchcancel",i)}function F(e){if(!_.value)return null;let t=[];t=e.touches,t=[];for(let i=0;i<e.touches.length;i++)t.push(e.touches[i]);let n=new m({type:"touchmove",touches:t.map((e=>{let t=D(e);return new y({x:e.clientX,y:e.clientY,diffX:t[0],diffY:t[1],direction:t[2],id:e.identifier})})),event:e});M("touchmove",n)}function H(e){let t=[];if(U.has(0)){let n=UTS.mapGet(U,0),i=e.clientX-UTS.mapGet(n,"x"),l=e.clientY-UTS.mapGet(n,"y");t=[i,l,Math.abs(i)>Math.abs(l)?i<0?"left":"right":l<0?"up":"down"]}else{let n=new Map;n.set("x",e.clientX),n.set("y",e.clientY),t=[0,0,""],U.set(0,n)}return t}function K(e){if(!_.value)return null;let t=H(e),n=new y({x:e.clientX,y:e.clientY,diffX:t[0],diffY:t[1],direction:t[2],id:0}),i=new m({type:"touchmove",touches:[n],event:e});M("touchmove",i)}function Q(e){if(null==e.target||k.getDataset(e.target,"sn-id")!=B.value)return null;_.value=!1;let t=H(e),n=new y({x:e.clientX,y:e.clientY,diffX:t[0],diffY:t[1],direction:t[2],id:0}),i=new m({type:"touchend",touches:[n],event:e});q([0]),M("touchend",i)}function V(e){_.value=!0;let t=H(e),n=new y({x:e.clientX,y:e.clientY,diffX:t[0],diffY:t[1],direction:t[2],id:0}),i=new m({type:"touchstart",touches:[n],event:e});M("down",i),M("touchstart",i)}return s((()=>{window.addEventListener("mouseup",Q),window.addEventListener("mousemove",K)})),(n=null,i=null)=>{const l=Y(u("sn-loading"),e),a=g;return w(),c(a,{ref:"viewEle","data-sn-id":r(B),class:f({disabled:t.disabled,loading:t.loading}),onClick:$,onLongpress:J,onTouchstart:N,onTouchmove:F,onTouchend:z,onTouchcancel:A,onMousedown:V,style:h([r(P),t.customStyle])},{default:d((()=>[t.loading?T("",!0):b(n.$slots,"default",{key:0},void 0,!0),!t.disabled&&t.loading?(w(),c(l,{key:1})):T("",!0),r(C)?(w(),c(a,{key:2,class:"sn-view-disabled-mask",ref_key:"maskEle",ref:E,style:h([r(R)])},null,8,["style"])):T("",!0)])),_:3},8,["data-sn-id","class","style"])}}})),[["__scopeId","data-v-a96f2225"]]);export{x as _};
