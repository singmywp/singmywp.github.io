import{d as e,c as t}from"./sn-button.BaZjRh9m.js";import{d as n,r as i,w as l,c as o,l as a,b as s,e as u,f as c,u as d,p as r,q as f,k as h,o as p,t as v,v as m,m as y}from"./index-DNTc1GxZ.js";import{$ as g,r as w,l as b,m as T,n as X}from"./uni-app.es.D9ZkitmT.js";const Y=t(n(Object.assign({name:"sn-view"},{__name:"sn-view",props:{loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},bgColor:{type:String,default:""},borderRadius:{type:String,default:""},margin:{type:String,default:"0"},padding:{type:String,default:"0"},boxShadow:{type:String,default:""},aniTime:{type:Number,default:parseInt(g.configs.aniTime.long)},customStyle:{type:Object,default:{}}},emits:["click","longpress","dbclick","touchstart","touchmove","touchend","touchcancel","down"],setup(t,n){var Y=n.emit;const x=g.colors,k=g.utils,S=Y,M=t,_=i(null),j=new Map,G=i(!1),U=i(!1),C=i(k.randomComId()),E=i(null);l((()=>M.disabled),(e=>{var t,n;e?(U.value=!0,y((()=>{k.debounce((()=>{var e,t;null===(t=null===(e=E.value)||void 0===e?void 0:e.style)||void 0===t||t.setProperty("opacity",.3)}),50,C.value)}))):(null===(n=null===(t=E.value)||void 0===t?void 0:t.style)||void 0===n||n.setProperty("opacity",0),k.debounce((()=>{U.value=!1}),M.aniTime,C.value))}),{immediate:!0});const I=o((()=>{let e=new Map;return e.set("background",M.bgColor),e.set("padding",M.padding),e.set("box-shadow",M.boxShadow),e.set("border-radius",M.borderRadius),e.set("justify-content",M.loading?"center":""),e.set("align-items",M.loading?"center":""),e.set("transition-duration","".concat(M.aniTime,"ms")),e})),L=o((()=>{let e=new Map;return e.set("background",x.value.disabled),e.set("transition-duration","".concat(M.aniTime,"ms")),e}));function B(e){let t="click";null==_.value?_.value=setTimeout((()=>{_.value=null}),300):(clearTimeout(_.value),_.value=null,t="dbclick");let n=new b({type:t,event:e,x:e.clientX,y:e.clientY});S("down",n),S("dbclick"==t?"dbclick":"click",n)}function O(e){for(let t=0;t<e.length;t++)j.delete(e[t])}function P(e){let t=[];if(j.has(e.identifier)){let n=UTS.mapGet(j,e.identifier),i=e.clientX-UTS.mapGet(n,"x"),l=e.clientY-UTS.mapGet(n,"y");t=[i,l,Math.abs(i)>Math.abs(l)?i<0?"left":"right":l<0?"up":"down"]}else{let n=new Map;n.set("x",e.clientX),n.set("y",e.clientY),t=[0,0,""],j.set(e.identifier,n)}return t}function R(e){let t=[];t=e.touches,t=[];for(let i=0;i<e.touches.length;i++)t.push(e.touches[i]);let n=new T({type:"longpress",touches:t.map((e=>{let t=P(e);return new X({x:e.clientX,y:e.clientY,diffX:t[0],diffY:t[1],direction:"",id:e.identifier})})),event:e});S("longpress",n)}function $(e){G.value=!0;let t=[];t=e.touches,t=[];for(let i=0;i<e.touches.length;i++)t.push(e.touches[i]);let n=new T({type:"touchstart",touches:t.map((e=>{let t=P(e);return new X({x:e.clientX,y:e.clientY,diffX:t[0],diffY:t[1],direction:t[2],id:e.identifier})})),event:e});S("down",n),S("touchstart",n)}function q(e){G.value=!1;let t=[],n=[];n=e.changedTouches,n=[];for(let l=0;l<e.changedTouches.length;l++)n.push(e.changedTouches[l]);let i=new T({type:"touchend",touches:n.map((e=>{let n=P(e);return t.push(e.identifier),new X({x:e.clientX,y:e.clientY,diffX:n[0],diffY:n[1],direction:n[2],id:e.identifier})})),event:e});O(t),S("touchend",i)}function D(e){G.value=!1;let t=[],n=[];n=e.changedTouches,n=[];for(let l=0;l<e.changedTouches.length;l++)n.push(e.changedTouches[l]);let i=new T({type:"touchcancel",touches:n.map((e=>{let n=P(e);return t.push(e.identifier),new X({x:e.clientX,y:e.clientY,diffX:n[0],diffY:n[1],direction:n[2],id:e.identifier})})),event:e});O(t),S("touchcancel",i)}function N(e){if(!G.value)return null;let t=[];t=e.touches,t=[];for(let i=0;i<e.touches.length;i++)t.push(e.touches[i]);let n=new T({type:"touchmove",touches:t.map((e=>{let t=P(e);return new X({x:e.clientX,y:e.clientY,diffX:t[0],diffY:t[1],direction:t[2],id:e.identifier})})),event:e});S("touchmove",n)}function z(e){let t=[];if(j.has(0)){let n=UTS.mapGet(j,0),i=e.clientX-UTS.mapGet(n,"x"),l=e.clientY-UTS.mapGet(n,"y");t=[i,l,Math.abs(i)>Math.abs(l)?i<0?"left":"right":l<0?"up":"down"]}else{let n=new Map;n.set("x",e.clientX),n.set("y",e.clientY),t=[0,0,""],j.set(0,n)}return t}function A(e){if(!G.value)return null;let t=z(e),n=new X({x:e.clientX,y:e.clientY,diffX:t[0],diffY:t[1],direction:t[2],id:0}),i=new T({type:"touchmove",touches:[n],event:e});S("touchmove",i)}function F(e){if(null==e.target||k.getDataset(e.target,"sn-id")!=C.value)return null;G.value=!1;let t=z(e),n=new X({x:e.clientX,y:e.clientY,diffX:t[0],diffY:t[1],direction:t[2],id:0}),i=new T({type:"touchend",touches:[n],event:e});O([0]),S("touchend",i)}function H(e){G.value=!0;let t=z(e),n=new X({x:e.clientX,y:e.clientY,diffX:t[0],diffY:t[1],direction:t[2],id:0}),i=new T({type:"touchstart",touches:[n],event:e});S("down",i),S("touchstart",i)}return a((()=>{window.addEventListener("mouseup",F),window.addEventListener("mousemove",A)})),(n=null,i=null)=>{const l=w(s("sn-loading"),e),o=h;return p(),u(o,{ref:"viewEle","data-sn-id":d(C),class:r({disabled:t.disabled,loading:t.loading}),onClick:B,onLongpress:R,onTouchstart:$,onTouchmove:N,onTouchend:q,onTouchcancel:D,onMousedown:H,style:f([d(I),t.customStyle])},{default:c((()=>[t.loading?m("",!0):v(n.$slots,"default",{key:0},void 0,!0),!t.disabled&&t.loading?(p(),u(l,{key:1})):m("",!0),d(U)?(p(),u(o,{key:2,class:"sn-view-disabled-mask",ref_key:"maskEle",ref:E,style:f([d(L)])},null,8,["style"])):m("",!0)])),_:3},8,["data-sn-id","class","style"])}}})),[["__scopeId","data-v-82497b88"]]);export{Y as _};
