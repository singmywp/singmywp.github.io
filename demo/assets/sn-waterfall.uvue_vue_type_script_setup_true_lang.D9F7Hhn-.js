import{d as e,$ as t,r as l,l as a,c as s,w as u,o as n,n as i,aO as o,e as d,f as r,p as v,u as c,x as f,_ as p,b as g,B as m,z as h,q as y,L as x,aP as w,C as S,Y as b,M as O}from"./index-DYMgrqHp.js";import{b as _}from"./sn-text.euomPoe8.js";import{u as j}from"./useResize.Cfi37DcV.js";const P=_(e(Object.assign({name:"sn-waterfall-item"},{__name:"sn-waterfall-item",props:{index:{type:Number,default:0},height:{type:String,default:""},imgSrc:{type:String,default:""},bgColor:{type:String,default:""},padding:{type:String,default:"0px"},borderRadius:{type:String,default:""},imgBorderRadius:{type:String,default:"0px"},customStyle:{type:Object,default:new UTSJSONObject({})},customImageStyle:{type:Object,default:new UTSJSONObject({})}},setup(e){const S=t.utils,b=t.colors,O=y(),_=e,j=S.randomComId(),P=l(null),R=l(0),M=l(0),C=l(0),I=l(0);l(0);const $=l(0),N=l(0),k=a("width",l(0)),B=a("col",l(2)),E=a("spacing",l(10)),L=a("itemList",l([])),T=l(null),J=s((()=>!S.isEmpty(_.imgSrc))),U=s((()=>f("color",_.bgColor,b.value.front))),z=s((()=>f("radius",_.borderRadius,t.configs.radius.normal))),q=s((()=>{const e=new Map;return e.set("opacity",$.value),e.set("background",U.value),e.set("borderRadius",z.value),e.set("padding",_.padding),e.set("top",S.addPx(M.value)),e.set("left",S.addPx(R.value)),e.set("width",C.value>0?S.addPx(C.value):""),e.set("transition-duration","100ms"),e})),F=s((()=>{const e=new Map;return e.set("borderRadius",_.imgBorderRadius),e.set("width",C.value>0?S.addPx(C.value):""),e}));function W(){var e,t,l,a;let s=0,u=Math.floor(_.index/B.value),n=_.index%B.value,i=B.value*(u-1)+n;if(L.value.length>i&&i>=0){let e=L.value[i];s=e.top+e.height+E.value}M.value=s,C.value=(k.value-E.value*B.value)/B.value;let o=_.index%B.value,d=Math.floor(_.index/B.value);N.value=d,R.value=(C.value+E.value)*o,S.isEmpty(_.height)?I.value=null!==(l=null===(t=null===(e=P.value)||void 0===e?void 0:e.getBoundingClientRect())||void 0===t?void 0:t.height)&&void 0!==l?l:0:I.value=S.getPx(_.height);let r=new w({id:j,top:M.value,left:R.value,width:C.value,height:I.value,node:O.proxy});null===(a=T.value)||void 0===a||a.$callMethod("register",r)}function Y(){$.value=0,W(),setTimeout((()=>{W(),$.value=1}),200)}function A(e){Y()}return u(k,(()=>{Y()})),n((()=>{i((()=>{T.value=S.findParent(O.proxy,["sn-waterfall"]),Y()}))})),o((()=>{var e;null===(e=T.value)||void 0===e||e.$callMethod("unregister",j)})),(t=null,l=null)=>{const a=x,s=p;return g(),d(s,{class:"sn-waterfall-item",ref_key:"itemEle",ref:P,style:v([c(q),e.customStyle])},{default:r((()=>[c(J)?(g(),d(a,{key:0,mode:"widthFix",src:e.imgSrc,style:v([c(F),e.customImageStyle]),onLoad:A},null,8,["src","style"])):m("",!0),h(t.$slots,"default",{},void 0,!0)])),_:3},8,["style"])}}})),[["__scopeId","data-v-b9a44cd3"]]),R=e(Object.assign({name:"sn-waterfall"},{__name:"sn-waterfall",props:{col:{type:Number,default:2},spacing:{type:String,default:"10px"},customStyle:{type:Object,default:new UTSJSONObject({})}},setup(e,a){var u=a.expose;const i=t.utils;t.colors;const o=y(),f=e,m=l(null),x=l([]),w=l(0),_=l(0),P=s((()=>i.getPx(f.spacing))),R=s((()=>f.col));S("itemList",x),S("width",w),S("col",R),S("spacing",P);const M=s((()=>{const e=new Map;return e.set("height",i.addPx(_.value)),e}));function C(){if(x.value.length>0){let e=x.value[x.value.length-1];e.height>0&&(_.value=e.top+e.height+e.height/2)}else _.value=0}function I(){b().in(o.proxy).select(".sn-waterfall").boundingClientRect().exec((e=>{var t;if(e.length>0){let l=e[0];w.value=null!==(t=l.width)&&void 0!==t?t:O().windowWidth}}))}return n((()=>{I(),j(m.value,(()=>{I()}))})),u({register:function(e){let t=x.value.findIndex((t=>t.id==e.id));-1!=t?x.value.splice(t,1,e):x.value.push(e),C()},unregister:function(e){let t=x.value.findIndex((t=>t.id==e));-1!=t&&x.value.splice(t,1),C()}}),(t=null,l=null)=>{const a=p;return g(),d(a,{class:"sn-waterfall",ref_key:"waterfallEle",ref:m,style:v([c(M),e.customStyle])},{default:r((()=>[h(t.$slots,"default")])),_:3},8,["style"])}}}));export{P as _,R as a};
