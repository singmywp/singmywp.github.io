import{d as e,$ as t,r as l,k as a,c as u,w as s,l as n,m as i,aX as o,b as r,e as d,q as v,u as c,z as f,j as g,o as p,v as m,t as h,x as y,M as w,aY as S,y as x,ai as b,N as O}from"./index-BDGnenFq.js";import{c as j}from"./sn-button.DCeBN0oM.js";import{u as _}from"./useResize.C1IVTLMN.js";const N=j(e(Object.assign({name:"sn-waterfall-item"},{__name:"sn-waterfall-item",props:{index:{type:Number,default:0},height:{type:String,default:""},imgSrc:{type:String,default:""},bgColor:{type:String,default:""},padding:{type:String,default:"0px"},borderRadius:{type:String,default:""},imgBorderRadius:{type:String,default:"0px"},customStyle:{type:Object,default:new UTSJSONObject(new UTSJSONObject({}))},customImageStyle:{type:Object,default:new UTSJSONObject(new UTSJSONObject({}))}},setup(e){const x=t.utils,b=t.colors,O=y(),j=e,_=x.randomComId(),N=l(null),R=l(0),M=l(0),P=l(0),T=l(0);l(0);const I=l(0),J=l(0),U=a("width",l(0)),k=a("col",l(2)),C=a("spacing",l(10)),$=a("itemList",l([])),E=l(null),z=u((()=>!x.isEmpty(j.imgSrc))),B=u((()=>f("color",j.bgColor,b.value.front))),L=u((()=>f("radius",j.borderRadius,t.configs.radius.normal))),F=u((()=>{let e=new Map;return e.set("opacity",I.value),e.set("background",B.value),e.set("borderRadius",L.value),e.set("padding",j.padding),e.set("top",x.addPx(M.value)),e.set("left",x.addPx(R.value)),e.set("width",P.value>0?x.addPx(P.value):""),e.set("transition-duration","100ms"),e})),q=u((()=>{let e=new Map;return e.set("borderRadius",j.imgBorderRadius),e.set("width",P.value>0?x.addPx(P.value):""),e}));function W(){var e,t,l,a;let u=0,s=Math.floor(j.index/k.value),n=j.index%k.value,i=k.value*(s-1)+n;if($.value.length>i&&i>=0){let e=$.value[i];u=e.top+e.height+C.value}M.value=u,P.value=(U.value-C.value*k.value)/k.value;let o=j.index%k.value,r=Math.floor(j.index/k.value);J.value=r,R.value=(P.value+C.value)*o,x.isEmpty(j.height)?T.value=null!==(l=null===(t=null===(e=N.value)||void 0===e?void 0:e.getBoundingClientRect())||void 0===t?void 0:t.height)&&void 0!==l?l:0:T.value=x.getPx(j.height);let d=new S({id:_,top:M.value,left:R.value,width:P.value,height:T.value,node:O.proxy});null===(a=E.value)||void 0===a||a.$callMethod("register",d)}function X(){I.value=0,W(),setTimeout((()=>{W(),I.value=1}),200)}function Y(e){X()}return s(U,(()=>{X()})),n((()=>{i((()=>{E.value=x.findParent(O.proxy,["sn-waterfall"]),X()}))})),o((()=>{var e;null===(e=E.value)||void 0===e||e.$callMethod("unregister",_)})),(t=null,l=null)=>{const a=w,u=g;return p(),r(u,{class:"sn-waterfall-item",ref_key:"itemEle",ref:N,style:v([c(F),e.customStyle])},{default:d((()=>[c(z)?(p(),r(a,{key:0,mode:"widthFix",src:e.imgSrc,style:v([c(q),e.customImageStyle]),onLoad:Y},null,8,["src","style"])):m("",!0),h(t.$slots,"default",{},void 0,!0)])),_:3},8,["style"])}}})),[["__scopeId","data-v-4914aa01"]]),R=e(Object.assign({name:"sn-waterfall"},{__name:"sn-waterfall",props:{col:{type:Number,default:2},spacing:{type:String,default:"10px"},customStyle:{type:Object,default:new UTSJSONObject(new UTSJSONObject({}))}},setup(e,a){var s=a.expose;const i=t.utils;t.colors;const o=y(),f=e,m=l(null),w=l([]),S=l(0),j=l(0),N=u((()=>i.getPx(f.spacing))),R=u((()=>f.col));x("itemList",w),x("width",S),x("col",R),x("spacing",N);const M=u((()=>{let e=new Map;return e.set("height",i.addPx(j.value)),e}));function P(){if(w.value.length>0){let e=w.value[w.value.length-1];e.height>0&&(j.value=e.top+e.height+e.height/2)}else j.value=0}function T(){b().in(o.proxy).select(".sn-waterfall").boundingClientRect().exec((e=>{var t;if(e.length>0){let l=e[0];S.value=null!==(t=l.width)&&void 0!==t?t:O().windowWidth}}))}return n((()=>{T(),_(m.value,(()=>{T()}))})),s({register:function(e){let t=w.value.findIndex((t=>t.id==e.id));-1!=t?w.value.splice(t,1,e):w.value.push(e),P()},unregister:function(e){let t=w.value.findIndex((t=>t.id==e));-1!=t&&w.value.splice(t,1),P()}}),(t=null,l=null)=>{const a=g;return p(),r(a,{class:"sn-waterfall",ref_key:"waterfallEle",ref:m,style:v([c(M),e.customStyle])},{default:d((()=>[h(t.$slots,"default")])),_:3},8,["style"])}}}));export{N as _,R as a};
