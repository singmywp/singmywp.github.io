import{d as e,$ as t,r as l,k as a,c as u,w as s,l as n,m as i,aY as o,b as r,e as d,q as v,u as c,y as f,j as g,o as p,C as m,B as h,t as y,M as w,aZ as S,D as x,ai as b,N as O}from"./index-DoInGK9X.js";import{c as j}from"./sn-button.B1LvAG78.js";import{u as _}from"./useResize.Dia-r-oM.js";const M=j(e(Object.assign({name:"sn-waterfall-item"},{__name:"sn-waterfall-item",props:{index:{type:Number,default:0},height:{type:String,default:""},imgSrc:{type:String,default:""},bgColor:{type:String,default:""},padding:{type:String,default:"0px"},borderRadius:{type:String,default:""},imgBorderRadius:{type:String,default:"0px"},customStyle:{type:Object,default:new UTSJSONObject(new UTSJSONObject({}))},customImageStyle:{type:Object,default:new UTSJSONObject(new UTSJSONObject({}))}},setup(e){const x=t.utils,b=t.colors,O=y(),j=e,_=x.randomComId(),M=l(null),N=l(0),R=l(0),P=l(0),T=l(0);l(0);const C=l(0),I=l(0),J=a("width",l(0)),U=a("col",l(2)),k=a("spacing",l(10)),$=a("itemList",l([])),B=l(null),E=u((()=>!x.isEmpty(j.imgSrc))),L=u((()=>f("color",j.bgColor,b.value.front))),q=u((()=>f("radius",j.borderRadius,t.configs.radius.normal))),z=u((()=>{let e=new Map;return e.set("opacity",C.value),e.set("background",L.value),e.set("borderRadius",q.value),e.set("padding",j.padding),e.set("top",x.addPx(R.value)),e.set("left",x.addPx(N.value)),e.set("width",P.value>0?x.addPx(P.value):""),e.set("transition-duration","100ms"),e})),D=u((()=>{let e=new Map;return e.set("borderRadius",j.imgBorderRadius),e.set("width",P.value>0?x.addPx(P.value):""),e}));function F(){var e,t,l,a;let u=0,s=Math.floor(j.index/U.value),n=j.index%U.value,i=U.value*(s-1)+n;if($.value.length>i&&i>=0){let e=$.value[i];u=e.top+e.height+k.value}R.value=u,P.value=(J.value-k.value*U.value)/U.value;let o=j.index%U.value,r=Math.floor(j.index/U.value);I.value=r,N.value=(P.value+k.value)*o,x.isEmpty(j.height)?T.value=null!==(l=null===(t=null===(e=M.value)||void 0===e?void 0:e.getBoundingClientRect())||void 0===t?void 0:t.height)&&void 0!==l?l:0:T.value=x.getPx(j.height);let d=new S({id:_,top:R.value,left:N.value,width:P.value,height:T.value,node:O.proxy});null===(a=B.value)||void 0===a||a.$callMethod("register",d)}function G(){C.value=0,F(),setTimeout((()=>{F(),C.value=1}),200)}function W(e){G()}return s(J,(()=>{G()})),n((()=>{i((()=>{B.value=x.findParent(O.proxy,["sn-waterfall"]),G()}))})),o((()=>{var e;null===(e=B.value)||void 0===e||e.$callMethod("unregister",_)})),(t=null,l=null)=>{const a=w,u=g;return p(),r(u,{class:"sn-waterfall-item",ref_key:"itemEle",ref:M,style:v([c(z),e.customStyle])},{default:d((()=>[c(E)?(p(),r(a,{key:0,mode:"widthFix",src:e.imgSrc,style:v([c(D),e.customImageStyle]),onLoad:W},null,8,["src","style"])):m("",!0),h(t.$slots,"default",{},void 0,!0)])),_:3},8,["style"])}}})),[["__scopeId","data-v-4914aa01"]]),N=e(Object.assign({name:"sn-waterfall"},{__name:"sn-waterfall",props:{col:{type:Number,default:2},spacing:{type:String,default:"10px"},customStyle:{type:Object,default:new UTSJSONObject(new UTSJSONObject({}))}},setup(e,a){var s=a.expose;const i=t.utils;t.colors;const o=y(),f=e,m=l(null),w=l([]),S=l(0),j=l(0),M=u((()=>i.getPx(f.spacing))),N=u((()=>f.col));x("itemList",w),x("width",S),x("col",N),x("spacing",M);const R=u((()=>{let e=new Map;return e.set("height",i.addPx(j.value)),e}));function P(){if(w.value.length>0){let e=w.value[w.value.length-1];e.height>0&&(j.value=e.top+e.height+e.height/2)}else j.value=0}function T(){b().in(o.proxy).select(".sn-waterfall").boundingClientRect().exec((e=>{var t;if(e.length>0){let l=e[0];S.value=null!==(t=l.width)&&void 0!==t?t:O().windowWidth}}))}return n((()=>{T(),_(m.value,(()=>{T()}))})),s({register:function(e){let t=w.value.findIndex((t=>t.id==e.id));-1!=t?w.value.splice(t,1,e):w.value.push(e),P()},unregister:function(e){let t=w.value.findIndex((t=>t.id==e));-1!=t&&w.value.splice(t,1),P()}}),(t=null,l=null)=>{const a=g;return p(),r(a,{class:"sn-waterfall",ref_key:"waterfallEle",ref:m,style:v([c(R),e.customStyle])},{default:d((()=>[h(t.$slots,"default")])),_:3},8,["style"])}}}));export{M as _,N as a};
